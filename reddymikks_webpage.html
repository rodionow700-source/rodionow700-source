<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Linear Programming Solver (Reddy Mikks)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .block { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 6px; }
    .constraints { margin-top: 10px; }
    button { margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Linear Programming Solver (Reddy Mikks)</h1>

  <div class="block">
    <h2>Objective Function</h2>
    Max Z = <input id="objA" type="number" step="any" placeholder="a"> * x1 +
            <input id="objB" type="number" step="any" placeholder="b"> * x2
  </div>

  <div class="block">
    <h2>Resource Constraints</h2>
    <div>M1: <input id="m1x1" type="number" step="any"> * x1 + <input id="m1x2" type="number" step="any"> * x2 ≤ <input id="m1s" type="number" step="any"></div>
    <div>M2: <input id="m2x1" type="number" step="any"> * x1 + <input id="m2x2" type="number" step="any"> * x2 ≤ <input id="m2s" type="number" step="any"></div>
  </div>

  <div class="block">
    <h2>Demand Constraints</h2>
    <div id="demandList"></div>
    <button onclick="addDemand()">Add Constraint</button>
  </div>

  <button onclick="solveLP()">Solve</button>

  <h2>Result:</h2>
  <div id="result"></div>

  <canvas id="chart" width="600" height="400"></canvas>

  <script>
    let demandCount = 0;

    function addDemand() {
      demandCount++;
      const div = document.createElement('div');
      div.id = 'd' + demandCount;
      div.innerHTML = `
        <input type="number" step="any" class="dx1"> * x1 +
        <input type="number" step="any" class="dx2"> * x2 ≤
        <input type="number" step="any" class="ds">
        <button onclick="removeDemand('d${demandCount}')">Delete</button>
      `;
      document.getElementById('demandList').appendChild(div);
    }

    function removeDemand(id) {
      document.getElementById(id).remove();
    }

    function solveLP() {
      const constraints = [];

      function collect(x1, x2, s) {
        if (!isNaN(x1) && !isNaN(x2) && !isNaN(s)) constraints.push([x1, x2, s]);
      }

      collect(parseFloat(m1x1.value), parseFloat(m1x2.value), parseFloat(m1s.value));
      collect(parseFloat(m2x1.value), parseFloat(m2x2.value), parseFloat(m2s.value));

      document.querySelectorAll('#demandList > div').forEach(div => {
        const x1 = parseFloat(div.querySelector('.dx1').value);
        const x2 = parseFloat(div.querySelector('.dx2').value);
        const s = parseFloat(div.querySelector('.ds').value);
        collect(x1, x2, s);
      });

      const a = parseFloat(objA.value);
      const b = parseFloat(objB.value);

      const pts = [[0,0]];

      constraints.forEach((c1, i) => {
        for (let j = i+1; j < constraints.length; j++) {
          const c2 = constraints[j];
          const det = c1[0]*c2[1] - c2[0]*c1[1];
          if (Math.abs(det) > 1e-9) {
            const x = (c1[2]*c2[1] - c2[2]*c1[1]) / det;
            const y = (c1[0]*c2[2] - c2[0]*c1[2]) / det;
            if (x >= 0 && y >= 0) pts.push([x,y]);
          }
        }
      });

      const feasible = pts.filter(p => constraints.every(c => c[0]*p[0] + c[1]*p[1] <= c[2] + 1e-9));

      if (feasible.length === 0) {
        document.getElementById('result').innerText = 'No feasible solution.';
        return;
      }

      let best = feasible[0];
      let bestVal = a*best[0] + b*best[1];

      feasible.forEach(p => {
        const v = a*p[0] + b*p[1];
        if (v > bestVal) { bestVal = v; best = p; }
      });

      document.getElementById('result').innerText = `x1 = ${best[0].toFixed(3)}, x2 = ${best[1].toFixed(3)}, Z = ${bestVal.toFixed(3)}`;

      drawChart(constraints, best);
    }

    function drawChart(constraints, best){
      const ctx = document.getElementById('chart').getContext('2d');
      const dataSets = [];

      constraints.forEach((c, i) => {
        const x = 0;
        const y = c[2]/c[1];
        const x2 = c[2]/c[0];
        dataSets.push({
          label: 'Constraint ' + (i+1),
          data: [ {x:0, y:y}, {x:x2, y:0} ],
          borderWidth: 1,
          fill: false
        });
      });

      dataSets.push({
        label: 'Solution',
        data: [{x: best[0], y: best[1]}],
        pointRadius: 6,
      });

      new Chart(ctx, {
        type: 'scatter',
        data: { datasets: dataSets },
        options: {
          scales: { x: { type:'linear', min:0 }, y: { type:'linear', min:0 } }
        }
      });
    }
  </script>
</body>
</html>
